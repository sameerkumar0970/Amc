<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Campus IT Support</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
</head>
<body class="admin-page">
    <div class="admin-container">
        <!-- Admin Header -->
        <header class="admin-header">
            <div class="logo">
                <i class="fas fa-user-shield"></i>
                <div>
                    <h1>Admin Dashboard</h1>
                    <p class="admin-info">Full System Access | <span id="adminName">Administrator</span></p>
                </div>
            </div>
            <div class="header-actions">
                <div class="admin-stats">
                    <span class="stat-badge" id="liveTickets">0 Live</span>
                    <span class="stat-badge urgent" id="urgentTickets">0 Urgent</span>
                </div>
                <button class="btn-admin" onclick="refreshDashboard()">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
                <button class="btn-admin" onclick="goToHome()">
                    <i class="fas fa-home"></i> Home
                </button>
                <button class="btn-admin logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </header>

        <!-- Admin Navigation -->
        <nav class="admin-nav">
            <ul>
                <li><a href="#" class="nav-active" onclick="showAdminSection('dashboard')"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li><a href="#" onclick="showAdminSection('all-tickets')"><i class="fas fa-ticket-alt"></i> All Tickets</a></li>
                <li><a href="#" onclick="showAdminSection('manage-tickets')"><i class="fas fa-tasks"></i> Manage Tickets</a></li>
                <li><a href="#" onclick="showAdminSection('reports')"><i class="fas fa-chart-pie"></i> Reports</a></li>
                <li><a href="#" onclick="showAdminSection('users')"><i class="fas fa-users"></i> Users</a></li>
                <li><a href="#" onclick="showAdminSection('settings')"><i class="fas fa-cog"></i> Settings</a></li>
            </ul>
        </nav>

        <!-- Main Admin Content -->
        <main class="admin-main">
            <!-- Dashboard Section -->
            <section id="dashboard" class="admin-section active">
                <div class="dashboard-header">
                    <h2><i class="fas fa-tachometer-alt"></i> System Overview</h2>
                    <div class="time-display">
                        <i class="fas fa-clock"></i>
                        <span id="currentDateTime"></span>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div class="quick-stats">
                    <div class="stat-card total">
                        <i class="fas fa-ticket-alt"></i>
                        <div>
                            <h3 id="totalTicketsAdmin">0</h3>
                            <p>Total Tickets</p>
                        </div>
                        <div class="stat-trend up">+12%</div>
                    </div>
                    <div class="stat-card pending">
                        <i class="fas fa-clock"></i>
                        <div>
                            <h3 id="pendingTicketsAdmin">0</h3>
                            <p>Pending</p>
                        </div>
                        <div class="stat-trend up">+5%</div>
                    </div>
                    <div class="stat-card progress">
                        <i class="fas fa-spinner"></i>
                        <div>
                            <h3 id="progressTicketsAdmin">0</h3>
                            <p>In Progress</p>
                        </div>
                        <div class="stat-trend down">-3%</div>
                    </div>
                    <div class="stat-card resolved">
                        <i class="fas fa-check-circle"></i>
                        <div>
                            <h3 id="resolvedTicketsAdmin">0</h3>
                            <p>Resolved</p>
                        </div>
                        <div class="stat-trend up">+8%</div>
                    </div>
                    <div class="stat-card users">
                        <i class="fas fa-users"></i>
                        <div>
                            <h3 id="totalUsers">0</h3>
                            <p>Total Users</p>
                        </div>
                        <div class="stat-trend up">+15%</div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3><i class="fas fa-history"></i> Recent Tickets</h3>
                        <div class="recent-tickets" id="recentTickets">
                            <!-- Recent tickets loaded here -->
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <h3><i class="fas fa-chart-pie"></i> Category Distribution</h3>
                        <div class="chart-container">
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <h3><i class="fas fa-exclamation-triangle"></i> Urgent Tickets</h3>
                        <div class="urgent-list" id="urgentList">
                            <!-- Urgent tickets loaded here -->
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <h3><i class="fas fa-user-clock"></i> Technician Performance</h3>
                        <div class="performance-list" id="performanceList">
                            <!-- Performance data loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                    <div class="action-buttons">
                        <button class="btn-action" onclick="showAdminSection('manage-tickets')">
                            <i class="fas fa-tasks"></i> Assign Tickets
                        </button>
                        <button class="btn-action" onclick="exportAllTickets()">
                            <i class="fas fa-download"></i> Export Data
                        </button>
                        <button class="btn-action" onclick="bulkUpdateStatus()">
                            <i class="fas fa-check-double"></i> Bulk Update
                        </button>
                        <button class="btn-action" onclick="sendBroadcast()">
                            <i class="fas fa-bullhorn"></i> Send Alert
                        </button>
                        <button class="btn-action" onclick="clearOldTickets()">
                            <i class="fas fa-trash"></i> Cleanup Old
                        </button>
                        <button class="btn-action" onclick="backupDatabase()">
                            <i class="fas fa-database"></i> Backup
                        </button>
                    </div>
                </div>
            </section>

            <!-- All Tickets Section -->
            <section id="all-tickets" class="admin-section">
                <div class="section-header">
                    <h2><i class="fas fa-ticket-alt"></i> All Tickets</h2>
                    <div class="header-controls">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="ticketSearch" placeholder="Search tickets...">
                        </div>
                        <div class="filter-controls">
                            <select id="filterStatusAdmin">
                                <option value="all">All Status</option>
                                <option value="pending">Pending</option>
                                <option value="in-progress">In Progress</option>
                                <option value="resolved">Resolved</option>
                            </select>
                            <select id="filterCategoryAdmin">
                                <option value="all">All Categories</option>
                                <option value="laptop">Laptop</option>
                                <option value="printer">Printer</option>
                                <option value="networking">Networking</option>
                            </select>
                            <select id="filterUrgencyAdmin">
                                <option value="all">All Urgency</option>
                                <option value="urgent">Urgent</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="tickets-table-container">
                    <table id="ticketsTable" class="display">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="selectAll"></th>
                                <th>Ticket ID</th>
                                <th>User</th>
                                <th>Category</th>
                                <th>Description</th>
                                <th>Status</th>
                                <th>Urgency</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ticketsTableBody">
                            <!-- Tickets loaded dynamically -->
                        </tbody>
                    </table>
                </div>

                <div class="table-actions">
                    <button class="btn-table" onclick="bulkAssign()">
                        <i class="fas fa-user-plus"></i> Assign Selected
                    </button>
                    <button class="btn-table" onclick="bulkUpdate()">
                        <i class="fas fa-check-double"></i> Update Status
                    </button>
                    <button class="btn-table delete" onclick="bulkDelete()">
                        <i class="fas fa-trash"></i> Delete Selected
                    </button>
                    <button class="btn-table export" onclick="exportTable()">
                        <i class="fas fa-file-excel"></i> Export to Excel
                    </button>
                </div>
            </section>

            <!-- Manage Tickets Section -->
            <section id="manage-tickets" class="admin-section">
                <div class="section-header">
                    <h2><i class="fas fa-tasks"></i> Manage Tickets</h2>
                    <div class="ticket-queue">
                        <div class="queue-item active">Pending <span class="badge" id="pendingCount">0</span></div>
                        <div class="queue-item">In Progress <span class="badge" id="progressCount">0</span></div>
                        <div class="queue-item">Assigned to Me <span class="badge" id="assignedCount">0</span></div>
                        <div class="queue-item">Urgent <span class="badge urgent" id="urgentCount">0</span></div>
                    </div>
                </div>

                <div class="manage-grid">
                    <!-- Pending Tickets -->
                    <div class="manage-column">
                        <h3><i class="fas fa-clock"></i> Pending Tickets</h3>
                        <div class="ticket-column" id="pendingColumn">
                            <!-- Pending tickets loaded here -->
                        </div>
                    </div>

                    <!-- In Progress Tickets -->
                    <div class="manage-column">
                        <h3><i class="fas fa-spinner"></i> In Progress</h3>
                        <div class="ticket-column" id="progressColumn">
                            <!-- In progress tickets loaded here -->
                        </div>
                    </div>

                    <!-- Ticket Details Panel -->
                    <div class="manage-column details-panel">
                        <h3><i class="fas fa-info-circle"></i> Ticket Details</h3>
                        <div class="ticket-details" id="ticketDetailsPanel">
                            <div class="no-selection">
                                <i class="fas fa-mouse-pointer"></i>
                                <p>Select a ticket to view details</p>
                            </div>
                        </div>
                        
                        <div class="action-panel" id="actionPanel">
                            <h4>Actions</h4>
                            <div class="action-buttons">
                                <button class="btn-action" onclick="assignToMe()">
                                    <i class="fas fa-user-plus"></i> Assign to Me
                                </button>
                                <button class="btn-action" onclick="startProgress()">
                                    <i class="fas fa-play"></i> Start Progress
                                </button>
                                <button class="btn-action" onclick="markResolved()">
                                    <i class="fas fa-check"></i> Mark Resolved
                                </button>
                                <button class="btn-action" onclick="addNote()">
                                    <i class="fas fa-comment"></i> Add Note
                                </button>
                                <button class="btn-action" onclick="escalateTicket()">
                                    <i class="fas fa-exclamation"></i> Escalate
                                </button>
                            </div>
                            
                            <div class="assign-form">
                                <h4>Assign to Technician</h4>
                                <select id="technicianSelect">
                                    <option value="">Select Technician</option>
                                    <option value="tech1">John (Network)</option>
                                    <option value="tech2">Sarah (Hardware)</option>
                                    <option value="tech3">Mike (Software)</option>
                                    <option value="tech4">Priya (General)</option>
                                </select>
                                <button class="btn-assign" onclick="assignToTech()">
                                    <i class="fas fa-user-check"></i> Assign
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="reports" class="admin-section">
                <div class="section-header">
                    <h2><i class="fas fa-chart-pie"></i> Reports & Analytics</h2>
                    <div class="report-controls">
                        <div class="date-range">
                            <input type="date" id="reportFrom">
                            <span>to</span>
                            <input type="date" id="reportTo">
                            <button class="btn-generate" onclick="generateReport()">
                                <i class="fas fa-chart-line"></i> Generate
                            </button>
                        </div>
                        <select id="reportType">
                            <option value="daily">Daily Report</option>
                            <option value="weekly">Weekly Report</option>
                            <option value="monthly">Monthly Report</option>
                            <option value="custom">Custom Period</option>
                        </select>
                    </div>
                </div>

                <div class="reports-grid">
                    <div class="report-card">
                        <h3><i class="fas fa-chart-bar"></i> Ticket Trends</h3>
                        <div class="chart-container">
                            <canvas id="trendChart"></canvas>
                        </div>
                    </div>

                    <div class="report-card">
                        <h3><i class="fas fa-clock"></i> Resolution Time</h3>
                        <div class="chart-container">
                            <canvas id="resolutionChart"></canvas>
                        </div>
                    </div>

                    <div class="report-card">
                        <h3><i class="fas fa-users"></i> Department-wise</h3>
                        <div class="chart-container">
                            <canvas id="deptChart"></canvas>
                        </div>
                    </div>

                    <div class="report-card">
                        <h3><i class="fas fa-star"></i> Technician Performance</h3>
                        <div class="performance-chart">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="report-details">
                    <h3><i class="fas fa-table"></i> Detailed Report</h3>
                    <div class="report-table-container">
                        <table id="reportTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>New Tickets</th>
                                    <th>Resolved</th>
                                    <th>Avg. Time</th>
                                    <th>Top Category</th>
                                    <th>Technician</th>
                                </tr>
                            </thead>
                            <tbody id="reportTableBody">
                                <!-- Report data loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Users Section -->
            <section id="users" class="admin-section">
                <div class="section-header">
                    <h2><i class="fas fa-users"></i> User Management</h2>
                    <div class="user-controls">
                        <button class="btn-add-user" onclick="addNewUser()">
                            <i class="fas fa-user-plus"></i> Add User
                        </button>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="userSearch" placeholder="Search users...">
                        </div>
                    </div>
                </div>

                <div class="users-grid">
                    <div class="users-list">
                        <div class="user-filters">
                            <select id="userFilter">
                                <option value="all">All Users</option>
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                                <option value="frequent">Frequent Users</option>
                            </select>
                        </div>
                        <div class="users-table-container">
                            <table id="usersTable">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Mobile</th>
                                        <th>Department</th>
                                        <th>Tickets</th>
                                        <th>Last Active</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <!-- Users loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="user-details">
                        <h3><i class="fas fa-user-cog"></i> User Details</h3>
                        <div class="user-info-panel" id="userInfoPanel">
                            <div class="no-selection">
                                <i class="fas fa-user"></i>
                                <p>Select a user to view details</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="admin-section">
                <div class="section-header">
                    <h2><i class="fas fa-cog"></i> System Settings</h2>
                </div>

                <div class="settings-tabs">
                    <div class="settings-nav">
                        <button class="settings-tab active" data-tab="general">General</button>
                        <button class="settings-tab" data-tab="categories">Categories</button>
                        <button class="settings-tab" data-tab="technicians">Technicians</button>
                        <button class="settings-tab" data-tab="notifications">Notifications</button>
                        <button class="settings-tab" data-tab="backup">Backup</button>
                        <button class="settings-tab" data-tab="security">Security</button>
                    </div>

                    <div class="settings-content">
                        <!-- General Settings -->
                        <div id="general" class="settings-panel active">
                            <h3><i class="fas fa-sliders-h"></i> General Settings</h3>
                            <div class="settings-form">
                                <div class="form-group">
                                    <label>System Name</label>
                                    <input type="text" id="systemName" value="Campus IT Support System">
                                </div>
                                <div class="form-group">
                                    <label>Auto-refresh Interval (minutes)</label>
                                    <input type="number" id="refreshInterval" value="5" min="1" max="60">
                                </div>
                                <div class="form-group">
                                    <label>Default Technician</label>
                                    <select id="defaultTech">
                                        <option value="auto">Auto Assign</option>
                                        <option value="tech1">John</option>
                                        <option value="tech2">Sarah</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Ticket Auto-close (days)</label>
                                    <input type="number" id="autoCloseDays" value="30" min="1" max="365">
                                </div>
                                <button class="btn-save" onclick="saveSettings()">
                                    <i class="fas fa-save"></i> Save Settings
                                </button>
                            </div>
                        </div>

                        <!-- Category Settings -->
                        <div id="categories" class="settings-panel">
                            <h3><i class="fas fa-tags"></i> Manage Categories</h3>
                            <div class="categories-list" id="categoriesList">
                                <!-- Categories loaded here -->
                            </div>
                            <div class="add-category">
                                <input type="text" id="newCategory" placeholder="New category name">
                                <button class="btn-add" onclick="addCategory()">
                                    <i class="fas fa-plus"></i> Add
                                </button>
                            </div>
                        </div>

                        <!-- Technician Settings -->
                        <div id="technicians" class="settings-panel">
                            <h3><i class="fas fa-user-tie"></i> Technician Management</h3>
                            <div class="technicians-list" id="techniciansList">
                                <!-- Technicians loaded here -->
                            </div>
                            <button class="btn-add" onclick="addTechnician()">
                                <i class="fas fa-user-plus"></i> Add Technician
                            </button>
                        </div>

                        <!-- Notification Settings -->
                        <div id="notifications" class="settings-panel">
                            <h3><i class="fas fa-bell"></i> Notification Settings</h3>
                            <div class="notification-settings">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="emailNotifications" checked>
                                    <span>Email Notifications</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="smsNotifications">
                                    <span>SMS Notifications</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="urgentAlerts" checked>
                                    <span>Urgent Ticket Alerts</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="dailyReports">
                                    <span>Daily Reports</span>
                                </label>
                            </div>
                        </div>

                        <!-- Backup Settings -->
                        <div id="backup" class="settings-panel">
                            <h3><i class="fas fa-database"></i> Backup & Restore</h3>
                            <div class="backup-actions">
                                <button class="btn-backup" onclick="createBackup()">
                                    <i class="fas fa-download"></i> Create Backup
                                </button>
                                <button class="btn-backup" onclick="restoreBackup()">
                                    <i class="fas fa-upload"></i> Restore Backup
                                </button>
                                <button class="btn-backup" onclick="exportAllData()">
                                    <i class="fas fa-file-export"></i> Export All Data
                                </button>
                            </div>
                            <div class="backup-list" id="backupList">
                                <!-- Backup history loaded here -->
                            </div>
                        </div>

                        <!-- Security Settings -->
                        <div id="security" class="settings-panel">
                            <h3><i class="fas fa-shield-alt"></i> Security Settings</h3>
                            <div class="security-settings">
                                <div class="form-group">
                                    <label>Change Admin Password</label>
                                    <input type="password" id="newPassword" placeholder="New password">
                                    <input type="password" id="confirmPassword" placeholder="Confirm password">
                                </div>
                                <div class="form-group">
                                    <label>Session Timeout (minutes)</label>
                                    <input type="number" id="sessionTimeout" value="30" min="5" max="240">
                                </div>
                                <div class="form-group">
                                    <label>Max Login Attempts</label>
                                    <input type="number" id="maxAttempts" value="3" min="1" max="10">
                                </div>
                                <button class="btn-save" onclick="saveSecurity()">
                                    <i class="fas fa-save"></i> Save Security Settings
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Admin Footer -->
        <footer class="admin-footer">
            <div class="footer-info">
                <p><i class="fas fa-server"></i> System Status: <span class="online">Online</span></p>
                <p><i class="fas fa-database"></i> Database: <span id="dbSize">0 KB</span></p>
                <p><i class="fas fa-users"></i> Active Users: <span id="activeUsers">0</span></p>
            </div>
            <p class="copyright">&copy; 2024 Campus IT Support System | Admin Panel v2.0</p>
        </footer>
    </div>

    <!-- Modals -->
    <div id="adminModal" class="modal">
        <div class="modal-content admin-modal">
            <span class="close-modal">&times;</span>
            <div id="adminModalContent"></div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>
    <script src="admin.js"></script>
</body>
</html>